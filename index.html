<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TARS E-Ink Display</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600;700&family=IBM+Plex+Mono:wght@400;500;600&family=Literata:opsz,wght@7..72,400;7..72,600;7..72,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/eink.css">
</head>
<body>
    <!-- E-ink Screen Frame -->
    <div class="eink-frame">
        <!-- Paper Texture Overlay -->
        <div class="paper-texture"></div>
        <div class="paper-grain"></div>

        <!-- E-ink Refresh Flash Overlay -->
        <div class="ink-flash-overlay" id="ink-flash"></div>

        <!-- Screen Bezel -->
        <div class="bezel">
            <div class="bezel-top">
                <span class="bezel-brand">TARS</span>
                <span class="bezel-model">E-INK DISPLAY // MK-IV</span>
                <div class="power-led" id="power-led"></div>
            </div>

            <!-- Main Display Area -->
            <div class="display-area">

                <!-- Password Overlay -->
                <div class="password-overlay" id="password-overlay">
                    <div class="lock-screen">
                        <div class="lock-icon">
                            <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="8" y="20" width="32" height="24" rx="2" stroke="currentColor" stroke-width="2"/>
                                <path d="M16 20V12C16 7.58172 19.5817 4 24 4C28.4183 4 32 7.58172 32 12V20" stroke="currentColor" stroke-width="2"/>
                                <circle cx="24" cy="32" r="3" fill="currentColor"/>
                            </svg>
                        </div>
                        <h1>Display Locked</h1>
                        <p class="subtitle">Enter access code to continue</p>
                        <input type="password" class="password-input" id="password-input" placeholder="••••••••••" maxlength="12">
                        <button class="btn btn-primary" onclick="verifyPassword()">UNLOCK</button>
                        <div class="error-msg" id="error-msg"></div>
                        <div class="device-info">
                            <span>FW: v2.1.0-eink</span>
                            <span>SN: TARS-2026-0131</span>
                        </div>
                    </div>
                </div>

                <!-- Main Dashboard -->
                <div class="dashboard" id="dashboard" style="display: none;">

                    <!-- Header -->
                    <header class="dashboard-header">
                        <div class="brand">
                            <!-- TARS Avatar -->
                            <div class="tars-avatar" id="tars-avatar" data-state="active">
                                <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges">
                                    <!-- Head frame -->
                                    <rect x="8" y="8" width="32" height="32" rx="2" stroke="currentColor" stroke-width="2.5"/>
                                    <!-- Antenna -->
                                    <line x1="24" y1="8" x2="24" y2="4" stroke="currentColor" stroke-width="2"/>
                                    <circle cx="24" cy="3" r="2" fill="currentColor"/>
                                    <!-- Eyes - Active (open circles) -->
                                    <g class="avatar-eyes active-eyes">
                                        <circle cx="17" cy="20" r="4" fill="currentColor"/>
                                        <circle cx="31" cy="20" r="4" fill="currentColor"/>
                                    </g>
                                    <!-- Eyes - Thinking (narrow slits) -->
                                    <g class="avatar-eyes thinking-eyes" style="display: none;">
                                        <line x1="13" y1="20" x2="21" y2="20" stroke="currentColor" stroke-width="2.5"/>
                                        <line x1="27" y1="20" x2="35" y2="20" stroke="currentColor" stroke-width="2.5"/>
                                    </g>
                                    <!-- Eyes - Alert (wide open) -->
                                    <g class="avatar-eyes alert-eyes" style="display: none;">
                                        <circle cx="17" cy="20" r="5" fill="none" stroke="currentColor" stroke-width="2"/>
                                        <circle cx="17" cy="20" r="2.5" fill="currentColor"/>
                                        <circle cx="31" cy="20" r="5" fill="none" stroke="currentColor" stroke-width="2"/>
                                        <circle cx="31" cy="20" r="2.5" fill="currentColor"/>
                                    </g>
                                    <!-- Mouth - Active (slight smile) -->
                                    <g class="avatar-mouth active-mouth">
                                        <path d="M16 34C16 34 20 37 24 37C28 37 32 34 32 34" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"/>
                                    </g>
                                    <!-- Mouth - Thinking (neutral line) -->
                                    <g class="avatar-mouth thinking-mouth" style="display: none;">
                                        <line x1="18" y1="35" x2="30" y2="35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    </g>
                                    <!-- Mouth - Alert (slight frown) -->
                                    <g class="avatar-mouth alert-mouth" style="display: none;">
                                        <path d="M16 36C16 36 20 33 24 33C28 33 32 36 32 36" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"/>
                                    </g>
                                    <!-- Alert indicator (warning triangle) -->
                                    <g class="avatar-alert-indicator" style="display: none;">
                                        <path d="M40 4L44 12H36L40 4Z" fill="currentColor"/>
                                        <line x1="40" y1="7" x2="40" y2="9" stroke="white" stroke-width="1.5"/>
                                        <circle cx="40" cy="10.5" r="0.8" fill="white"/>
                                    </g>
                                </svg>
                                <!-- Status dot -->
                                <span class="avatar-status-dot" id="avatar-status-dot" title="Active"></span>
                            </div>
                            <div class="brand-text">
                                <h1>TARS</h1>
                                <span class="tagline">Neural Command</span>
                            </div>
                        </div>
                        <div class="status-bar">
                            <div class="battery-indicator">
                                <span class="bat-icon">▮▮▮▮</span>
                                <span class="bat-level">87%</span>
                            </div>
                            <div class="connection-dot" id="conn-dot" title="Connected"></div>
                            <span class="clock" id="current-time">--:--</span>
                        </div>
                    </header>

                    <!-- Hero: Neural Core -->
                    <section class="hero-eink">
                        <div class="core-display">
                            <div class="core-label">NEURAL MEMORIES</div>
                            <div class="core-value" id="memories">
                                <span class="digit-group" data-value="0">0</span>
                                <span class="digit-group" data-value="0">0</span>
                                <span class="digit-group" data-value="0">0</span>
                            </div>
                            <div class="core-sublabel">stored vectors in ChromaDB</div>
                        </div>
                        <div class="core-stats">
                            <div class="cstat">
                                <span class="cstat-val" id="uptime">--</span>
                                <span class="cstat-label">Days Active</span>
                            </div>
                            <div class="cstat">
                                <span class="cstat-val" id="skills">--</span>
                                <span class="cstat-label">Skills</span>
                            </div>
                            <div class="cstat">
                                <span class="cstat-val" id="deployments">--</span>
                                <span class="cstat-label">Deployments</span>
                            </div>
                        </div>
                    </section>

                    <!-- Insight Cards Grid -->
                    <section class="insights-eink">
                        <!-- Card 1: Priority Queue -->
                        <div class="insight-card" data-insight="priority" data-priority="normal">
                            <div class="insight-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" shape-rendering="crispEdges">
                                    <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                                    <path d="M2 17l10 5 10-5"/>
                                    <path d="M2 12l10 5 10-5"/>
                                </svg>
                            </div>
                            <div class="insight-content">
                                <span class="insight-title">PRIORITY QUEUE</span>
                                <span class="insight-value" id="insight-priority-value">--</span>
                                <span class="insight-context" id="insight-priority-context">Loading...</span>
                            </div>
                            <span class="insight-indicator"></span>
                        </div>

                        <!-- Card 2: System Health -->
                        <div class="insight-card" data-insight="health" data-priority="normal">
                            <div class="insight-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" shape-rendering="crispEdges">
                                    <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
                                </svg>
                            </div>
                            <div class="insight-content">
                                <span class="insight-title">SYSTEM HEALTH</span>
                                <span class="insight-value" id="insight-health-value">--</span>
                                <span class="insight-context" id="insight-health-context">Loading...</span>
                            </div>
                            <span class="insight-indicator"></span>
                        </div>

                        <!-- Card 3: Velocity -->
                        <div class="insight-card" data-insight="velocity" data-priority="normal">
                            <div class="insight-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" shape-rendering="crispEdges">
                                    <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                                </svg>
                            </div>
                            <div class="insight-content">
                                <span class="insight-title">VELOCITY</span>
                                <span class="insight-value" id="insight-velocity-value">--</span>
                                <span class="insight-context" id="insight-velocity-context">Loading...</span>
                            </div>
                            <span class="insight-indicator"></span>
                        </div>

                        <!-- Card 4: Attention -->
                        <div class="insight-card" data-insight="attention" data-priority="normal">
                            <div class="insight-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" shape-rendering="crispEdges">
                                    <circle cx="12" cy="12" r="10"/>
                                    <line x1="12" y1="8" x2="12" y2="12"/>
                                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                                </svg>
                            </div>
                            <div class="insight-content">
                                <span class="insight-title">ATTENTION</span>
                                <span class="insight-value" id="insight-attention-value">--</span>
                                <span class="insight-context" id="insight-attention-context">Loading...</span>
                            </div>
                            <span class="insight-indicator"></span>
                        </div>
                    </section>

                    <!-- System Status Matrix -->
                    <section class="system-eink">
                        <h2 class="section-title-eink">
                            <span class="sti-icon">◈</span>
                            SYSTEM STATUS
                        </h2>
                        <div class="status-matrix" id="system-status">
                            <!-- Dynamically populated -->
                        </div>
                    </section>

                    <!-- Live Operations -->
                    <section class="ops-eink">
                        <h2 class="section-title-eink">
                            <span class="sti-icon">⟳</span>
                            LIVE OPERATIONS
                        </h2>
                        <div class="ops-grid-eink">
                            <div class="ops-card-eink">
                                <h3>Active Jobs</h3>
                                <div class="ops-list" id="active-jobs">
                                    <!-- Dynamically populated -->
                                </div>
                            </div>
                            <div class="ops-card-eink">
                                <h3>System Log</h3>
                                <div class="ops-list log-list" id="recent-logs">
                                    <!-- Dynamically populated -->
                                </div>
                            </div>
                            <div class="ops-card-eink">
                                <h3>Recent Memories</h3>
                                <div class="ops-list mem-list" id="recent-memories">
                                    <!-- Dynamically populated -->
                                </div>
                            </div>
                            <div class="ops-card-eink">
                                <h3>Resources</h3>
                                <div class="ops-list res-list" id="system-resources">
                                    <!-- Dynamically populated -->
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Integration Panel -->
                    <section class="integration-eink">
                        <h2 class="section-title-eink">
                            <span class="sti-icon">◆</span>
                            INTEGRATIONS
                        </h2>
                        <div class="int-grid" id="integration-status">
                            <!-- Dynamically populated -->
                        </div>
                    </section>

                    <!-- Command History -->
                    <section class="commands-eink">
                        <h2 class="section-title-eink">
                            <span class="sti-icon">▶</span>
                            COMMAND HISTORY
                        </h2>
                        <div class="cmd-list" id="recent-commands">
                            <!-- Dynamically populated -->
                        </div>
                    </section>

                    <!-- Activity Stream -->
                    <section class="activity-eink">
                        <h2 class="section-title-eink">
                            <span class="sti-icon">◈</span>
                            ACTIVITY STREAM
                        </h2>
                        <div class="act-list" id="activity">
                            <!-- Dynamically populated -->
                        </div>
                    </section>

                    <!-- Latest Deployment -->
                    <section class="deploy-eink">
                        <h2 class="section-title-eink">
                            <span class="sti-icon">▲</span>
                            LATEST DEPLOYMENT
                        </h2>
                        <div class="deploy-card-eink">
                            <div class="deploy-info-eink">
                                <span class="deploy-name" id="last-deploy-name">--</span>
                                <span class="deploy-meta" id="last-deploy-meta">--</span>
                            </div>
                            <span class="deploy-time" id="last-deploy-time">--</span>
                        </div>
                    </section>

                    <!-- Footer / Control Bar -->
                    <footer class="footer-eink">
                        <div class="footer-left">
                            <span class="fw-version">Firmware v2.1.0-eink</span>
                            <span class="refresh-indicator" id="refresh-indicator">
                                <span class="ri-dot"></span>
                                <span id="last-sync">Sync: Never</span>
                            </span>
                        </div>
                        <div class="footer-center">
                            <span class="ink-logo">e•ink</span>
                        </div>
                        <div class="footer-right">
                            <button class="btn-eink" id="refresh-btn" onclick="manualRefresh()">
                                <svg class="refresh-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="23 4 23 10 17 10"/>
                                    <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
                                </svg>
                                REFRESH
                            </button>
                        </div>
                    </footer>

                </div><!-- /dashboard -->

            </div><!-- /display-area -->

            <!-- Bezel Bottom -->
            <div class="bezel-bottom">
                <span class="bezel-left">DISPLAY PORT: ACTIVE</span>
                <span class="bezel-center">TARS COMMAND SYSTEM</span>
                <span class="bezel-right" id="page-number">PAGE 1 OF 1</span>
            </div>
        </div><!-- /bezel -->
    </div><!-- /eink-frame -->

    <!-- Refresh Sound (optional, muted by default) -->
    <audio id="refresh-sound" preload="auto" muted>
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbqWEpKj+ozNqLUEhIgZ" type="audio/wav">
    </audio>

    <script src="js/dashboard.js"></script>
</body>
</html>
